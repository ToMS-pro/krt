<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Jadwal KA Parcel</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    select, button { padding: 6px; margin: 5px; }
    table { border-collapse: collapse; width: 100%; margin-top: 15px; }
    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: left; }
  </style>
</head>
<body>
  <h1>Jadwal KA Parcel</h1>

  <label for="asal">Stasiun Asal:</label>
  <select id="asal"></select>

  <label for="tujuan">Stasiun Tujuan:</label>
  <select id="tujuan"></select>

  <button onclick="cariJadwal()">Cari Jadwal</button>

  <div id="hasil"></div>

  <script>
    let dataKereta = [];
    let semuaStasiun = new Set();

    async function loadData() {
      const res = await fetch('data.json');
      dataKereta = await res.json();

      // Ambil semua nama stasiun
      dataKereta.forEach(kereta => {
        kereta.rute.forEach(r => semuaStasiun.add(r.stasiun));
      });

      const asal = document.getElementById('asal');
      const tujuan = document.getElementById('tujuan');
      Array.from(semuaStasiun).sort().forEach(st => {
        asal.innerHTML += `<option value="${st}">${st}</option>`;
        tujuan.innerHTML += `<option value="${st}">${st}</option>`;
      });
    }

    function cariJadwal() {
      const asal = document.getElementById('asal').value;
      const tujuan = document.getElementById('tujuan').value;
      const hasilDiv = document.getElementById('hasil');
      hasilDiv.innerHTML = '';

      const hasil = dataKereta.filter(kereta => {
        const rute = kereta.rute.map(r => r.stasiun);
        return rute.includes(asal) && rute.includes(tujuan) &&
               rute.indexOf(asal) < rute.indexOf(tujuan);
      });

      if (hasil.length === 0) {
        hasilDiv.innerHTML = '<p><strong>Tidak ada jadwal ditemukan.</strong></p>';
        return;
      }

      hasilDiv.innerHTML = hasil.map(kereta => {
        const rute = kereta.rute;
        const jamBerangkat = rute.find(r => r.stasiun === asal)?.ber || '-';
        const jamTiba = rute.find(r => r.stasiun === tujuan)?.dat || '-';
        return `
          <h2>${kereta.nama}</h2>
          <p><strong>Rute:</strong> ${kereta.asal} â†’ ${kereta.tujuan}</p>
          <p><strong>Berangkat dari ${asal}:</strong> ${jamBerangkat}</p>
          <p><strong>Tiba di ${tujuan}:</strong> ${jamTiba}</p>
        `;
      }).join('<hr>');
    }

    loadData();
  </script>
</body>
</html>
